<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>xharpy package &mdash; XHARPy 0.1.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="xharpy.f0j_sources package" href="xharpy.f0j_sources.html" />
    <link rel="prev" title="xharpy" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> XHARPy
            <img src="_static/XHARPy_logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="commandline.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="library/library_index.html">Scripting with XHARPy</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">xharpy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">xharpy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="xharpy.f0j_sources.html">xharpy.f0j_sources package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.cli">xharpy.cli module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.conversion">xharpy.conversion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.core">xharpy.core module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.io">xharpy.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.paper">xharpy.paper module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.quality">xharpy.quality module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.restraints">xharpy.restraints module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy.weighting">xharpy.weighting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-xharpy">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xharpy.f0j_sources.html">xharpy.f0j_sources package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">XHARPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="modules.html">xharpy</a> &raquo;</li>
      <li>xharpy package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/xharpy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="xharpy-package">
<h1>xharpy package<a class="headerlink" href="#xharpy-package" title="Permalink to this headline"></a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="xharpy.f0j_sources.html">xharpy.f0j_sources package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="xharpy.f0j_sources.html#usage">Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="xharpy.f0j_sources.html#development">Development</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="xharpy.f0j_sources.rho.html">xharpy.f0j_sources.rho package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="xharpy.f0j_sources.rho.html#module-xharpy.f0j_sources.rho">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.gpaw_lcorr_source">xharpy.f0j_sources.gpaw_lcorr_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.gpaw_mbis_source">xharpy.f0j_sources.gpaw_mbis_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.gpaw_mpi_source">xharpy.f0j_sources.gpaw_mpi_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.gpaw_source">xharpy.f0j_sources.gpaw_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.gpaw_spherical_source">xharpy.f0j_sources.gpaw_spherical_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.iam_source">xharpy.f0j_sources.iam_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.qe_source">xharpy.f0j_sources.qe_source module</a></li>
<li class="toctree-l2"><a class="reference internal" href="xharpy.f0j_sources.html#module-xharpy.f0j_sources.real_spher_harm">xharpy.f0j_sources.real_spher_harm module</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-xharpy.cli">
<span id="xharpy-cli-module"></span><h2>xharpy.cli module<a class="headerlink" href="#module-xharpy.cli" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.cli.cli">
<span class="sig-prename descclassname"><span class="pre">xharpy.cli.</span></span><span class="sig-name descname"><span class="pre">cli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.cli.cli" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.cli.input_with_default">
<span class="sig-prename descclassname"><span class="pre">xharpy.cli.</span></span><span class="sig-name descname"><span class="pre">input_with_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">question</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.cli.input_with_default" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-xharpy.conversion">
<span id="xharpy-conversion-module"></span><h2>xharpy.conversion module<a class="headerlink" href="#module-xharpy.conversion" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.conversion.calc_sin_theta_ov_lambda">
<span class="sig-prename descclassname"><span class="pre">xharpy.conversion.</span></span><span class="sig-name descname"><span class="pre">calc_sin_theta_ov_lambda</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_mat_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.conversion.calc_sin_theta_ov_lambda" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the resolution in sin(theta)/lambda for the given set of miller
indicees</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_mat_f</strong> (<em>jnp.ndarray</em>) – size (3, 3) array containing the reciprocal lattice vectors</p></li>
<li><p><strong>index_vec_h</strong> (<em>jnp.ndarray</em>) – size (H, 3) array of Miller indicees of reflections</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sin_theta_ov_lambda</strong> – size (H) array containing the calculated values</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.conversion.cell_constants_to_M">
<span class="sig-prename descclassname"><span class="pre">xharpy.conversion.</span></span><span class="sig-name descname"><span class="pre">cell_constants_to_M</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'triclinic'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.conversion.cell_constants_to_M" title="Permalink to this definition"></a></dt>
<dd><p>Generates a matrix with the three lattice vectors as row vectors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>float</em>) – cell constant a in Angstroem</p></li>
<li><p><strong>b</strong> (<em>float</em>) – cell constant b in Angstroem</p></li>
<li><p><strong>c</strong> (<em>float</em>) – cell constant c in Angstroem</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – cell angle alpha in degree</p></li>
<li><p><strong>beta</strong> (<em>float</em>) – cell angle beta in degree</p></li>
<li><p><strong>gamma</strong> (<em>float</em>) – cell angle gamma in degree</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em><em>, </em><em>optional</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Does not make a difference for the calculation
of the matrix, but does make a difference for the derivatives to the
cell parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cell_mat_m</strong> – size (3, 3) array containing the cell vectors as row vectors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.conversion.ucif2ucart">
<span class="sig-prename descclassname"><span class="pre">xharpy.conversion.</span></span><span class="sig-name descname"><span class="pre">ucif2ucart</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_mats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.conversion.ucif2ucart" title="Permalink to this definition"></a></dt>
<dd><p>Calculate anistropic displacement matrices in the cartesian convention
from the displacement matrices in the cif convention
see: R. W. Grosse-Kunstleve and P. D. Adams J. Appl. Cryst 2002, p.478
eq. 3a + 4a</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_mat_m</strong> (<em>jnp.ndarray</em>) – size (3,3) array containing the cell vectors as row vectors</p></li>
<li><p><strong>u_mats</strong> (<em>jnp.ndarray</em>) – size (N, 3, 3) array containing the anisotropic displacement matrices in
cif format</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>u_cart</strong> – size (N, 3, 3) array of the matrices in cartesian convention</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-xharpy.core">
<span id="xharpy-core-module"></span><h2>xharpy.core module<a class="headerlink" href="#module-xharpy.core" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">AtomInstructions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion_real</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dispersion_imag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cijk</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dijkl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.AtomInstructions" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.cijk">
<span class="sig-name descname"><span class="pre">cijk</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.cijk" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.dijkl">
<span class="sig-name descname"><span class="pre">dijkl</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.dijkl" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 7</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.dispersion_imag">
<span class="sig-name descname"><span class="pre">dispersion_imag</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.dispersion_imag" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.dispersion_real">
<span class="sig-name descname"><span class="pre">dispersion_real</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.dispersion_real" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.element">
<span class="sig-name descname"><span class="pre">element</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.element" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.name">
<span class="sig-name descname"><span class="pre">name</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.occupancy">
<span class="sig-name descname"><span class="pre">occupancy</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.occupancy" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 8</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.uij">
<span class="sig-name descname"><span class="pre">uij</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.uij" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.AtomInstructions.xyz">
<span class="sig-name descname"><span class="pre">xyz</span></span><a class="headerlink" href="#xharpy.core.AtomInstructions.xyz" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.ConstrainedValues">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">ConstrainedValues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">variable_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">added_value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.ConstrainedValues" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.ConstrainedValues.added_value">
<span class="sig-name descname"><span class="pre">added_value</span></span><a class="headerlink" href="#xharpy.core.ConstrainedValues.added_value" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.ConstrainedValues.multiplicators">
<span class="sig-name descname"><span class="pre">multiplicators</span></span><a class="headerlink" href="#xharpy.core.ConstrainedValues.multiplicators" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.ConstrainedValues.special_position">
<span class="sig-name descname"><span class="pre">special_position</span></span><a class="headerlink" href="#xharpy.core.ConstrainedValues.special_position" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.ConstrainedValues.variable_indexes">
<span class="sig-name descname"><span class="pre">variable_indexes</span></span><a class="headerlink" href="#xharpy.core.ConstrainedValues.variable_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.FixedParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">FixedParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_position</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.FixedParameter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.FixedParameter.special_position">
<span class="sig-name descname"><span class="pre">special_position</span></span><a class="headerlink" href="#xharpy.core.FixedParameter.special_position" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.FixedParameter.value">
<span class="sig-name descname"><span class="pre">value</span></span><a class="headerlink" href="#xharpy.core.FixedParameter.value" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.MultiIndexParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">MultiIndexParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicators</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">added_value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.MultiIndexParameter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.MultiIndexParameter.added_value">
<span class="sig-name descname"><span class="pre">added_value</span></span><a class="headerlink" href="#xharpy.core.MultiIndexParameter.added_value" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.MultiIndexParameter.multiplicators">
<span class="sig-name descname"><span class="pre">multiplicators</span></span><a class="headerlink" href="#xharpy.core.MultiIndexParameter.multiplicators" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.MultiIndexParameter.par_indexes">
<span class="sig-name descname"><span class="pre">par_indexes</span></span><a class="headerlink" href="#xharpy.core.MultiIndexParameter.par_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.RefinedParameter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">RefinedParameter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">added_value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.RefinedParameter" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.RefinedParameter.added_value">
<span class="sig-name descname"><span class="pre">added_value</span></span><a class="headerlink" href="#xharpy.core.RefinedParameter.added_value" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.RefinedParameter.multiplicator">
<span class="sig-name descname"><span class="pre">multiplicator</span></span><a class="headerlink" href="#xharpy.core.RefinedParameter.multiplicator" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.RefinedParameter.par_index">
<span class="sig-name descname"><span class="pre">par_index</span></span><a class="headerlink" href="#xharpy.core.RefinedParameter.par_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.SingleTrigonalCalculated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">SingleTrigonalCalculated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane_atom1_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane_atom2_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.SingleTrigonalCalculated" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.SingleTrigonalCalculated.bound_atom_index">
<span class="sig-name descname"><span class="pre">bound_atom_index</span></span><a class="headerlink" href="#xharpy.core.SingleTrigonalCalculated.bound_atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.SingleTrigonalCalculated.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.SingleTrigonalCalculated.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.SingleTrigonalCalculated.plane_atom1_index">
<span class="sig-name descname"><span class="pre">plane_atom1_index</span></span><a class="headerlink" href="#xharpy.core.SingleTrigonalCalculated.plane_atom1_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.SingleTrigonalCalculated.plane_atom2_index">
<span class="sig-name descname"><span class="pre">plane_atom2_index</span></span><a class="headerlink" href="#xharpy.core.SingleTrigonalCalculated.plane_atom2_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">TetrahedralCalculated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom1_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom2_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom3_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated.bound_atom_index">
<span class="sig-name descname"><span class="pre">bound_atom_index</span></span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated.bound_atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated.tetrahedron_atom1_index">
<span class="sig-name descname"><span class="pre">tetrahedron_atom1_index</span></span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated.tetrahedron_atom1_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated.tetrahedron_atom2_index">
<span class="sig-name descname"><span class="pre">tetrahedron_atom2_index</span></span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated.tetrahedron_atom2_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralCalculated.tetrahedron_atom3_index">
<span class="sig-name descname"><span class="pre">tetrahedron_atom3_index</span></span><a class="headerlink" href="#xharpy.core.TetrahedralCalculated.tetrahedron_atom3_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">TetrahedralPositionConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom1_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom2_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tetrahedron_atom3_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint.bound_atom_name">
<span class="sig-name descname"><span class="pre">bound_atom_name</span></span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint.bound_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom1_name">
<span class="sig-name descname"><span class="pre">tetrahedron_atom1_name</span></span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom1_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom2_name">
<span class="sig-name descname"><span class="pre">tetrahedron_atom2_name</span></span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom2_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom3_name">
<span class="sig-name descname"><span class="pre">tetrahedron_atom3_name</span></span><a class="headerlink" href="#xharpy.core.TetrahedralPositionConstraint.tetrahedron_atom3_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">TorsionCalculated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_angle</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.TorsionCalculated" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.angle">
<span class="sig-name descname"><span class="pre">angle</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.angle" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.angle_atom_index">
<span class="sig-name descname"><span class="pre">angle_atom_index</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.angle_atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.bound_atom_index">
<span class="sig-name descname"><span class="pre">bound_atom_index</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.bound_atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.torsion_angle">
<span class="sig-name descname"><span class="pre">torsion_angle</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.torsion_angle" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionCalculated.torsion_atom_index">
<span class="sig-name descname"><span class="pre">torsion_atom_index</span></span><a class="headerlink" href="#xharpy.core.TorsionCalculated.torsion_atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">TorsionPositionConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">torsion_angle_add</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refine</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.angle">
<span class="sig-name descname"><span class="pre">angle</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.angle" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 4</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.angle_atom_name">
<span class="sig-name descname"><span class="pre">angle_atom_name</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.angle_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.bound_atom_name">
<span class="sig-name descname"><span class="pre">bound_atom_name</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.bound_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.refine">
<span class="sig-name descname"><span class="pre">refine</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.refine" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 6</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.torsion_angle_add">
<span class="sig-name descname"><span class="pre">torsion_angle_add</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.torsion_angle_add" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 5</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TorsionPositionConstraint.torsion_atom_name">
<span class="sig-name descname"><span class="pre">torsion_atom_name</span></span><a class="headerlink" href="#xharpy.core.TorsionPositionConstraint.torsion_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.TrigonalPositionConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">TrigonalPositionConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane_atom1_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plane_atom2_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.TrigonalPositionConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TrigonalPositionConstraint.bound_atom_name">
<span class="sig-name descname"><span class="pre">bound_atom_name</span></span><a class="headerlink" href="#xharpy.core.TrigonalPositionConstraint.bound_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TrigonalPositionConstraint.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.core.TrigonalPositionConstraint.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TrigonalPositionConstraint.plane_atom1_name">
<span class="sig-name descname"><span class="pre">plane_atom1_name</span></span><a class="headerlink" href="#xharpy.core.TrigonalPositionConstraint.plane_atom1_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.TrigonalPositionConstraint.plane_atom2_name">
<span class="sig-name descname"><span class="pre">plane_atom2_name</span></span><a class="headerlink" href="#xharpy.core.TrigonalPositionConstraint.plane_atom2_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.UEquivCalculated">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">UEquivCalculated</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.UEquivCalculated" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.UEquivCalculated.atom_index">
<span class="sig-name descname"><span class="pre">atom_index</span></span><a class="headerlink" href="#xharpy.core.UEquivCalculated.atom_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.UEquivCalculated.multiplicator">
<span class="sig-name descname"><span class="pre">multiplicator</span></span><a class="headerlink" href="#xharpy.core.UEquivCalculated.multiplicator" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.core.UEquivConstraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">UEquivConstraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bound_atom_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiplicator</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.core.UEquivConstraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.UEquivConstraint.bound_atom_name">
<span class="sig-name descname"><span class="pre">bound_atom_name</span></span><a class="headerlink" href="#xharpy.core.UEquivConstraint.bound_atom_name" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.UEquivConstraint.multiplicator">
<span class="sig-name descname"><span class="pre">multiplicator</span></span><a class="headerlink" href="#xharpy.core.UEquivConstraint.multiplicator" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.core.UIso">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">UIso</span></span><a class="headerlink" href="#xharpy.core.UIso" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">xharpy.core.Uiso</span></code></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.angle_with_esd">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">angle_with_esd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom3_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_par</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mat2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">DeviceArray([[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mat3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">DeviceArray([[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_vec3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.angle_with_esd" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the angle with its estimated standard deviation spanned by
atom1-atom2-atom3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1_name</strong> (<em>str</em>) – Label of the first outer atom of the angle</p></li>
<li><p><strong>atom2_name</strong> (<em>str</em>) – Label of the central atom of the angle</p></li>
<li><p><strong>atom3_name</strong> (<em>str</em>) – Label of the second outer atom of the angle</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of atomic instruction for reconstruction of the parameters.
Needs to be the same, that was used for refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array of refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array of the variance-covariance matrix</p></li>
<li><p><strong>cell_par</strong> (<em>jnp.ndarray</em>) – size (6) array of cell parameters in degrees and Angstroem. Depending
on the given crystal system only the first of equivalent values might
be used. If the angle has to be 90° the angle values will be ignored</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – size (6) array of the estimated standard deviation of cell parameters
Only certain values might be used, see cell_par</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
<li><p><strong>symm_mat2</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3, 3) symmetry matrix to convert the coordinate of atom2, defaults to
jnp.eye(3)</p></li>
<li><p><strong>symm_vec2</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3) array containing the translation vector for atom2,
defaults to jnp.zeros(3)</p></li>
<li><p><strong>symm_mat3</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3, 3) symmetry matrix to convert the coordinate of atom3, defaults to
jnp.eye(3)</p></li>
<li><p><strong>symm_vec3</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3) array containing the translation vector for atom3,
defaults to jnp.zeros(3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>angle</strong> (<em>float</em>) – calculated angle between the three atoms</p></li>
<li><p><strong>angle_esd</strong> (<em>float</em>) – estimated standard deviation for the calculated angle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.calc_f">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">calc_f</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cijk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dijkl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancies</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mat_f</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.core.calc_f" title="Permalink to this definition"></a></dt>
<dd><p>Given a set of parameters, calculate the structure factors for all given
reflections</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz</strong> (<em>jnp.ndarray</em>) – size (N,3) array of fractional coordinates for the atoms in the asymmetric
unit</p></li>
<li><p><strong>uij</strong> (<em>jnp.ndarray</em>) – size (N, 6) array of anisotropic displacement parameters (isotropic
parameters have to be transformed to anitropic parameters). Parameters
need to be in convention as used e.g. Shelxl or the cif as U.
Order: U11, U22, U33, U23, U13, U12</p></li>
<li><p><strong>cijk</strong> (<em>jnp.ndarray</em>) – size (N, 10) array of hird-order Gram-Charlier parameters as defined
in Inter. Tables of Cryst. B (2010): Eq 1.2.12.7. Order: C111, C222,
C333, C112, C122, C113, C133, C223, C233, C123</p></li>
<li><p><strong>dijkl</strong> (<em>jnp.ndarray</em>) – size (N, 15) array of fourth-order Gram-Charlier parameters as defined
in Inter. Tables of Cryst. B (2010): Eq 1.2.12.7. Order: D1111, D2222,
D3333, D1112, D1222, D1113, D_1333, D2223, D2333, D1122, D1133, D2233,
D1123, D1223, D1233</p></li>
<li><p><strong>occupancies</strong> (<em>jnp.ndarray</em>) – size (N) array of atomic occupancies. Atoms on special positions need to have
an occupancy of 1/multiplicity</p></li>
<li><p><strong>index_vec_h</strong> (<em>jnp.ndarray</em>) – size (H, 3) array of Miller indicees of observed reflections</p></li>
<li><p><strong>cell_mat_f</strong> (<em>jnp.ndarray</em>) – size (3, 3) array with the reciprocal lattice vectors (1/Angstroem) as row
vectors</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>jnp.ndarray</em><em>, </em><em>jnp.ndarray</em><em>]</em>) – size (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>f0j</strong> (<em>jnp.ndarray</em>) – size (K, N, H) array of atomic form factors for all reflections and symmetry
generated atoms within the unit cells. Atoms on special positions are
present multiple times and have the atomic form factor of the full atom.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>structure_factors</strong> – size (H)-sized array with complex structure factors for each reflection</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.calc_lsq_factory">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">calc_lsq_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensities_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0j_core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraint_instr_ind</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Callable</span></span></span><a class="headerlink" href="#xharpy.core.calc_lsq_factory" title="Permalink to this definition"></a></dt>
<dd><p>Creates calc_lsq functions that can be used with jax.jit and jax.grad.
This way we can account for the very different needs of structures, while
keeping the code down the line relatively simple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_mat_m</strong> (<em>jnp.ndarray</em>) – size (3, 3) array with the cell vectors as row vectors (Angstroem)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>jnp.ndarray</em><em>, </em><em>jnp.ndarray</em><em>]</em>) – size (K, 3, 3) array of symmetry  matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>index_vec_h</strong> (<em>jnp.ndarray</em>) – size (H, 3) array of Miller indicees of observed reflections</p></li>
<li><p><strong>intensities_obs</strong> (<em>jnp.ndarray</em>) – size (H) array of observed reflection intensities</p></li>
<li><p><strong>weights</strong> (<em>jnp.ndarray</em>) – size (H) array of weights for the individual reflections</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters</p></li>
<li><p><strong>f0j_core</strong> (<em>jnp.ndarray</em>) – size (N, H) array of atomic core form factors calculated separately</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary that contains options for the refinement.</p></li>
<li><p><strong>wavelength</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – wavelength of radiation used for measurement in Angstroem</p></li>
<li><p><strong>restraint_instr_ind</strong> (<em>List</em><em>[</em><em>Any</em><em>]</em><em>, </em><em>optional</em>) – List of internal restraint options. Is still very early in development,
probably buggy and should not be used for research at the moment, by
default []</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>calc_lsq</strong> – function that return the sum of least squares for a given set of
parameters and atomic form factors</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Callable</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Core treatment method not implemented</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.calc_var_cor_mat">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">calc_var_cor_mat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensities_obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0j_core</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f0j</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.core.calc_var_cor_mat" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the variance-covariance matrix for a given set of parameters
At the moment is pretty slow, as it is not parallelised over reflections</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell_mat_m</strong> (<em>jnp.ndarray</em>) – size (3, 3) array with the cell vectors as row vectors (Angstroem)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>jnp.ndarray</em><em>, </em><em>jnp.ndarray</em><em>]</em>) – size (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>index_vec_h</strong> (<em>jnp.ndarray</em>) – size (H, 3) array of Miller indicees of observed reflections</p></li>
<li><p><strong>intensities_obs</strong> (<em>jnp.ndarray</em>) – size (H) array of observed reflection intensities</p></li>
<li><p><strong>weights</strong> (<em>jnp.ndarray</em>) – size (H) array of weights for the individual reflections</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters</p></li>
<li><p><strong>f0j_core</strong> (<em>jnp.ndarray</em>) – size (N, H) array of atomic core form factors calculated separately</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array with the refined parameters</p></li>
<li><p><strong>f0j</strong> (<em>jnp.ndarray</em>) – size (K, N, H) array of atomic form factors for all reflections and symmetry
generated atoms within the unit cells. Atoms on special positions are
present multiple times and have the atomic form factor of the full atom.</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary that contains options for the refinement.</p></li>
<li><p><strong>wavelength</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – wavelength of radiation used for measurement in Angstroem, by default
None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>var_cov_mat</strong> – size (P, P) array containing the variance-covariance matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – Extinction method not implemented</p></li>
<li><p><strong>NotImplementedError</strong> – Core treatment not implemented</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.constrained_values_to_instruction">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">constrained_values_to_instruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">par_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraint</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><span class="pre">xharpy.core.ConstrainedValues</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">current_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.RefinedParameter" title="xharpy.core.RefinedParameter"><span class="pre">xharpy.core.RefinedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.FixedParameter" title="xharpy.core.FixedParameter"><span class="pre">xharpy.core.FixedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.MultiIndexParameter" title="xharpy.core.MultiIndexParameter"><span class="pre">xharpy.core.MultiIndexParameter</span></a><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.constrained_values_to_instruction" title="Permalink to this definition"></a></dt>
<dd><p>Convert the given constraint instruction to the internal parameter
representation for the construction instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par_index</strong> (<em>int</em>) – par_index as given in the ConstrainedValues</p></li>
<li><p><strong>mult</strong> (<em>float</em>) – multiplicator given in ConstrainedValues</p></li>
<li><p><strong>add</strong> (<em>float</em>) – added_value given in ConstrainedValues</p></li>
<li><p><strong>constraint</strong> (<a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><em>ConstrainedValues</em></a>) – Constraint that is the source of the parameter constraint</p></li>
<li><p><strong>current_index</strong> (<em>int</em>) – current index for assigning parameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>instruction</strong> – the appropriate RefinedParameter, MultiParameter or FixedParameter
object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Parameter</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.construct_esds">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">construct_esds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.construct_esds" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the estimated standard deviations for the calculated values
Will currently not resolve constraints, but might in the future.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array containing the variances and covariances, where P is the
number of refined parameters.</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xyz_esd</strong> (<em>jnp.ndarray</em>) – size (N, 3) array containing floats for valid and np.nan for fractional
positions where there are no estimated deviations. N is the number
of atoms in the asymmetric unit</p></li>
<li><p><strong>uij_esd</strong> (<em>jnp.ndarray</em>) – size (N, 6) array of esds of anisotropic displacement parameters</p></li>
<li><p><strong>cijkl_esd</strong> (<em>jnp.ndarray</em>) – size (N, 10) array of esds of third-order Gram-Charlier parameters</p></li>
<li><p><strong>dijkl_esd</strong> (<em>jnp.ndarray</em>) – size (N, 15) array of esds of third-order Gram-Charlier parameters</p></li>
<li><p><strong>occ_esd</strong> (<em>jnp.ndarray</em>) – size (N) array of esds of occupacions</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.construct_values">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">construct_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.construct_values" title="Permalink to this definition"></a></dt>
<dd><p>Reconstruct xyz, adp-parameters, Gram-Charlier parameters and occupancies
from the given construction instructions. Allows for the flexible usage of
combinations of fixed parameters and parameters that are refined, as well as
constraints</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – parameters used during the refinement</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters</p></li>
<li><p><strong>cell_mat_m</strong> (<em>jnp.ndarray</em>) – size (3, 3) array with the cell vectors as row vectors, used for Uiso
calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>xyz</strong> (<em>jnp.ndarray</em>) – size (N,3) array of fractional coordinates for the atoms in the asymmetric
unit</p></li>
<li><p><strong>uij</strong> (<em>jnp.ndarray</em>) – size (N, 6) array of anisotropic displacement parameters (isotropic
parameters are transformed to anitropic parameters). Parameters are in
the convention as used e.g. Shelxl or the cif as U. Order: U11, U22,
U33, U23, U13, U12</p></li>
<li><p><strong>cijk</strong> (<em>jnp.ndarray</em>) – size (N, 10) array of third-order Gram-Charlier parameters as defined in
Inter. Tables of Cryst. B (2010): Eq 1.2.12.7. Order: C111, C222, C333,
C112, C122, C113, C133, C223, C233, C123</p></li>
<li><p><strong>dijkl</strong> (<em>jnp.ndarray</em>) – size (N, 15) array of fourth-order Gram-Charlier parameters as defined in
Inter. Tables of Cryst. B (2010): Eq 1.2.12.7. Order: D1111, D2222,
D3333, D1112, D1222, D1113, D_1333, D2223, D2333, D1122, D1133, D2233,
D1123, D1223, D1233</p></li>
<li><p><strong>occupancies</strong> (<em>jnp.ndarray</em>) – size (N) array of atomic occupancies. Atoms on special positions have an
occupancy of 1/multiplicity</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.create_atom_table">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">create_atom_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#xharpy.core.create_atom_table" title="Permalink to this definition"></a></dt>
<dd><p>Recreates an atom table from the refined parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – size (6) array of cell parameters in degrees and Angstroem.</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of atomic instruction for reconstruction of the parameters.
Needs to be the same, that was used for refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array of refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array of the variance-covariance matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>atom_table</strong> – The atom_table dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.create_construction_instructions">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">create_construction_instructions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">constraint_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><span class="pre">xharpy.core.ConstrainedValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_for_gc3</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atoms_for_gc4</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exti0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-06</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.create_construction_instructions" title="Permalink to this definition"></a></dt>
<dd><p>Creates the list of atomic instructions that are used during the
refinement to reconstruct the atomic parameters from the parameter list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_table</strong> (<em>pd.DataFrame</em>) – pandas DataFrame that contains the atomic information. Columns are named
like their counterparts in the cif file but without the common start for
each table (e.g. atom_site_fract_x -&gt; fract_x). The easiest way to
generate an atom_table is with the cif2data function</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary that contains options for the refinement</p></li>
<li><p><strong>constraint_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><em>ConstrainedValues</em></a><em>]</em><em>]</em>) – outer key is the atom label. possible inner keys are: xyz, uij, cijk,
dijkl and occ. The value of the inner dict needs to be one of the
possible Constraint sources</p></li>
<li><p><strong>cell</strong> (<em>Optional</em><em>[</em><em>jnp.ndarray</em><em>]</em><em>, </em><em>optional</em>) – jnp.array containing the cell parameters. Only necessary to calculate
starting values for refined torsion angles of placed hydrogen atoms,
by default None</p></li>
<li><p><strong>atoms_for_gc3</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of atoms for which Gram-Charlier parametersof third order are to be
refined, by default []</p></li>
<li><p><strong>atoms_for_gc4</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – List of atoms for which Gram-Charlier parameters of fourth order are to
be refined, by default []</p></li>
<li><p><strong>scaling0</strong> (<em>float</em><em>, </em><em>optional</em>) – Starting value for the overall scaling factor, by default 1.0</p></li>
<li><p><strong>exti0</strong> (<em>float</em><em>, </em><em>optional</em>) – Starting value for the extinction correction parameter. Is only used
if extinction is actually refined, by default 1e-6</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>construction_instructions</strong> (<em>List[AtomInstructions]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>parameters0</strong> (<em>jnp.ndarray:</em>) – starting values for the parameters</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – Found one or more missing essential columns in atom_table</p></li>
<li><p><strong>NotImplementedError</strong> – Constraint Type is not implemented</p></li>
<li><p><strong>NotImplementedError</strong> – Uij-type is not implemented</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.distance_with_esd">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">distance_with_esd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_par</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mat2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">DeviceArray([[1.,</span> <span class="pre">0.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">1.,</span> <span class="pre">0.],</span> <span class="pre">[0.,</span> <span class="pre">0.,</span> <span class="pre">1.]],</span> <span class="pre">dtype=float64)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_vec2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">array([0.,</span> <span class="pre">0.,</span> <span class="pre">0.])</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.distance_with_esd" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the distance value of a given atom pair and its estimated
standart deviation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1_name</strong> (<em>str</em>) – Label of the first atom</p></li>
<li><p><strong>atom2_name</strong> (<em>str</em>) – label of the second atom</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of atomic instruction for reconstruction of the parameters.
Needs to be the same, that was used for refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array of refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array of the variance-covariance matrix</p></li>
<li><p><strong>cell_par</strong> (<em>jnp.ndarray</em>) – size (6) array of cell parameters in degrees and Angstroem. Depending
on the given crystal system only the first of equivalent values might
be used. If the angle has to be 90° the angle values will be ignored</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – size (6) array of the estimated standard deviation of cell parameters
Only certain values might be used, see cell_par</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
<li><p><strong>symm_mat2</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3, 3) symmetry matrix to convert the coordinate of atom2, defaults to
jnp.eye(3)</p></li>
<li><p><strong>symm_vec2</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – size (3) array containing the translation vector for atom2,
defaults to jnp.zeros(3)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>distance</strong> (<em>float</em>) – Calculated distance between the two atoms</p></li>
<li><p><strong>distance_esd</strong> (<em>float</em>) – Estimated standard deviation of the calculated distance</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.expand_symm_unique">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">expand_symm_unique</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">type_symbols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordinates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vec</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_symm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">magmoms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.expand_symm_unique" title="Permalink to this definition"></a></dt>
<dd><p>Expand the type_symbols and coordinates for one complete unit cell.
Atoms on special positions appear only once. For disorder on a special
position use skip_symm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type_symbols</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – Element symbols of the atoms in the asymmetric unit</p></li>
<li><p><strong>coordinates</strong> (<em>npt.NDArray</em><em>[</em><em>np.float64</em><em>]</em>) – size (N, 3) array of fractional atomic coordinates</p></li>
<li><p><strong>cell_mat_m</strong> (<em>npt.NDArray</em><em>[</em><em>np.float64</em><em>]</em>) – Matrix with cell vectors as column vectors, (Angstroem)</p></li>
<li><p><strong>symm_mats_vec</strong> (<em>Tuple</em><em>[</em><em>npt.NDArray</em><em>[</em><em>np.float64</em><em>]</em><em>, </em><em>npt.NDArray</em><em>[</em><em>np.float64</em><em>]</em><em>]</em>) – size (K, 3, 3) array of symmetry matrices and size (K, 3) array
of translation vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>skip_symm</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Symmetry elements with indexes given the list(s) in the dictionary
values with not be applied to the respective atoms with the atom names
given in the key(s). Indexes need to be identical to the ones in
symm_mats_vec., by default {}</p></li>
<li><p><strong>magmoms</strong> (<em>Optional</em><em>[</em><em>npt.NDArray</em><em>[</em><em>np.float64</em><em>]</em><em>]</em><em>, </em><em>optional</em>) – Magnetic Moments. The enforced symmetry might not be correcz, by default
None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>symm_positions</strong> (<em>npt.NDArray[np.float64]</em>) – size (M, 3) array of all unique atom positions within the unit cell</p></li>
<li><p><strong>symm_symbols</strong> (<em>List[str]</em>) – ist of length M with element symbols for the unique atom positions
within the unit cell</p></li>
<li><p><strong>reverse_indexes</strong> (<em>npt.NDArray[np.float64]</em>) – size (K, N) array with indexes mapping the unique atom positions back to
the individual symmetry elements and atom positions in the asymmetric
unit</p></li>
<li><p><strong>symm_magmoms</strong> (<em>Optional[npt.NDArray[np.float64]]]</em>) – magnetic moments for symmetry generated atoms. Undertested!</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.get_parameter_index">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">get_parameter_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.get_parameter_index" title="Permalink to this definition"></a></dt>
<dd><p>Return the index of the parameter for the given refinement dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter_name</strong> (<em>str</em>) – Name of the parameter, which is to be looked up</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dict with parameters for the refinement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>index</strong> – Integer with the index of the parameter in the parameter array if the
value is actually refined. None if value is not refined.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[int, None]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.get_value_or_default">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">get_value_or_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameter_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="headerlink" href="#xharpy.core.get_value_or_default" title="Permalink to this definition"></a></dt>
<dd><p>Central function for storing the default values of the refinement_dict
values. Always getting the default from here, means assumptions about
defaults will be the same throughout the library.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter_name</strong> (<em>str</em>) – Parameter that will be looked up</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dict with parameters for the refinement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>return_value</strong> – If the value is present in the refinement_dict, the value will be
returned from there. Otherwise the value from the defaults dictionary
will be returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.is_multientry">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">is_multientry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">bool</span></span></span><a class="headerlink" href="#xharpy.core.is_multientry" title="Permalink to this definition"></a></dt>
<dd><p>Check if argument is a multientry</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.refine">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">refine</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hkl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computation_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.refine" title="Permalink to this definition"></a></dt>
<dd><p>Refinement routine. The routine will refine for the given intensities
against wR2(F^2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>jnp.ndarray</em><em>, </em><em>jnp.ndarray</em><em>]</em>) – size (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>hkl</strong> (<em>pd.DataFrame</em>) – pandas DataFrame containing the reflection data. Needs to have at least
five columns: h, k, l, intensity, weight. Alternatively weight can be
substituted by esd_int. If no weight column is available the weights
will be calculated as 1/est_int**2. Additional columns will be ignored</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters from the
list of refined parameters</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – Starting values for the list of parameters</p></li>
<li><p><strong>wavelength</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>optional</em>) – Measurement wavelength in Angstroem. Currently only used for Shelxl
style extinction correction. Can be omitted otherwise, by default None</p></li>
<li><p><strong>refinement_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – <p>Dictionary with refinement options, by default {}
Available options are:</p>
<blockquote>
<div><ul>
<li><p>f0j_source:
Source of the atomic form factors. The computation_dict
will be passed on to this method. See the individual files in
f0j_sources for more information, by default ‘gpaw’
Tested options: ‘gpaw’, ‘iam’, ‘gpaw_mpi’
Some limitations: ‘gpaw_spherical’
Still untested: ‘gpaw_lcorr’, ‘gpaw_mbis’, ‘qe’</p></li>
<li><p>reload_step:
Starting with this step the computation will try to reuse the
density, if this is implemented in the source, by default 1</p></li>
<li><p>core:
If this is implemented in a f0j_source, it will integrate the
frozen core density on a spherical grid and only use the valence
density for the updated atomic form factos options are
‘combine’, which will not treat the core density separately,
‘constant’ which will integrate and add the core density without
scaling parameter and ‘scale’ which will refine a scaling
parameter for the core density which might for systematic
deviations due to a coarse valence density grid (untested!)
By default ‘constant’</p></li>
<li><p>extinction:
Use an extinction correction. Options: ‘none’ -&gt; no extinction
correction, ‘shelxl’ use the (empirical) formula used by SHELXL
to correct to correct for extinction, ‘secondary’ see Giacovazzo
et al. ‘Fundmentals of Crystallography’ (1992) p.97, by default
‘none’</p></li>
<li><p>flack:
Refinement of the flack parameter. Because xHARPy does not merge at
the moment this should not be considered really implemented,
by default False</p></li>
<li><p>max_dist_recalc:
If the max difference in atomic positions is under this value in
Angstroems, no new structure factors will be calculated, by
default 1e-6</p></li>
<li><p>max_iter:
Maximum of refinement cycles if convergence not reached, by
default: 100</p></li>
<li><p>min_iter:
Minimum refinement cycles. The refinement will stop if the
wR2 increases if the current cycle is higher than min_iter,
by default 10</p></li>
<li><p>core_io:
Expects a tuple where the first entry can be ‘save’, ‘load’, ‘none’
which is the action that is taken with the core density. The
second argument in the tuple is the filename, to which the core
density is saved to or loaded from</p></li>
<li><p>restraints:
Not fully implemented. Do not use at the moment, by default []</p></li>
</ul>
</div></blockquote>
</p></li>
<li><p><strong>computation_dict</strong> (<em>dict</em><em>, </em><em>optional</em>) – Dict with options that are passed on to the f0j_source. See the
individual calc_f0j functions for a more detailed description, by
default {}</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters.</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray,</em>) – variance covariance matrix of the final refinement step</p></li>
<li><p><strong>information</strong> (<em>Dict[str, Any]</em>) – Dictionary with additional information, some of this is needed for
cif output</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – f0j_source not implemented</p></li>
<li><p><strong>NotImplementedError</strong> – Unknown core description</p></li>
<li><p><strong>NotImplementedError</strong> – Second point where the core description could be missing</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.resolve_instruction">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">resolve_instruction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.RefinedParameter" title="xharpy.core.RefinedParameter"><span class="pre">xharpy.core.RefinedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.FixedParameter" title="xharpy.core.FixedParameter"><span class="pre">xharpy.core.FixedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.MultiIndexParameter" title="xharpy.core.MultiIndexParameter"><span class="pre">xharpy.core.MultiIndexParameter</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.core.resolve_instruction" title="Permalink to this definition"></a></dt>
<dd><p>Resolve a construction instruction to build the corresponding numerical
value</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array of parameters used for the refinement</p></li>
<li><p><strong>instruction</strong> (<em>Parameter</em>) – Instruction of one of the known instruction type namedtuples to generate
the numerical value from the parameters and/or the values in the
instruction</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a jax.numpy array of size 0 that contains the calculated value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Type of instruction is currently not one of the known namedtuple types</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.resolve_instruction_esd">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">resolve_instruction_esd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.RefinedParameter" title="xharpy.core.RefinedParameter"><span class="pre">xharpy.core.RefinedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.FixedParameter" title="xharpy.core.FixedParameter"><span class="pre">xharpy.core.FixedParameter</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.MultiIndexParameter" title="xharpy.core.MultiIndexParameter"><span class="pre">xharpy.core.MultiIndexParameter</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="headerlink" href="#xharpy.core.resolve_instruction_esd" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the estimated standard deviation (esd) for a value calculated
from a parameter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array containing the variances and covariances, where P is the
number of refined parameters.</p></li>
<li><p><strong>instruction</strong> (<em>Parameter</em>) – one parameter instruction, as used for generating atomic parameters
(and in this case esds) from the refined parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>esd</strong> – estimated standart deviation as float or np.nan if parameter has no esd</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Unknown type of Parameter used</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.core.u_iso_with_esd">
<span class="sig-prename descclassname"><span class="pre">xharpy.core.</span></span><span class="sig-name descname"><span class="pre">u_iso_with_esd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_par</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.core.u_iso_with_esd" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Uequiv value from anisotropic displacement parameters for
a given atom.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_name</strong> (<em>str</em>) – Label of the atom</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of atomic instruction for reconstruction of the parameters.
Needs to be the same, that was used for refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – size (P) array of refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – size (P, P) array of the variance-covariance matrix</p></li>
<li><p><strong>cell_par</strong> (<em>jnp.ndarray</em>) – size (6) array of cell parameters in degrees and Angstroem. Depending
on the given crystal system only the first of equivalent values might
be used. If the angle has to be 90° the angle values will be ignored</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – size (6) array of the estimated standard deviation of cell parameters
Only certain values might be used, see cell_par</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>u_equiv</strong> (<em>float</em>) – Calculated U(equiv) value</p></li>
<li><p><em>u_equiv_esd, float</em> – Estimated standard deviation of the U(equiv) value</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-xharpy.io">
<span id="xharpy-io-module"></span><h2>xharpy.io module<a class="headerlink" href="#module-xharpy.io" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.add_density_entries_from_fcf">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">add_density_entries_from_fcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcf6_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.io.add_density_entries_from_fcf" title="Permalink to this definition"></a></dt>
<dd><p>Adds the density entries to a cif file starting from the fcf6 file.
This is necessary because so far the difference density calculation
is not working properly. This introduces a dependency on the rather
large cctbx/iotbx library</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_path</strong> (<em>str</em>) – path to the cif-file to be completed</p></li>
<li><p><strong>fcf6_path</strong> (<em>str</em>) – path to the fcf6 file to be used for the difference electron density
calculation</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.add_from_cif">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">add_from_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cif</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.OrderedDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.add_from_cif" title="Permalink to this definition"></a></dt>
<dd><p>Try to add a value from another cif file, read in by ciflike_to_dict</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the cif entry</p></li>
<li><p><strong>cif</strong> (<em>OrderedDict</em>) – The dictionary generated from the read in cif file</p></li>
<li><p><strong>esd</strong> (<em>bool</em><em>, </em><em>optional</em>) – Value comes with an estimated standard deviation so this is considered
as well, by default False</p></li>
<li><p><strong>string_sign</strong> (<em>bool</em><em>, </em><em>optional</em>) – Value is a string and should also be written ‘like this’, by default
True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted entry if the value is present in the cif file. Otherwise the
entry will be marked with the . for a missing entry.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.cif2atom_type_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">cif2atom_type_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.OrderedDict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versionmajor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">versionminor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ishar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.cif2atom_type_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to create the atom_type table from a given cif</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif</strong> (<em>OrderedDict</em>) – The dictionary generated from the read in cif file</p></li>
<li><p><strong>versionmajor</strong> (<em>int</em>) – Major xharpy version</p></li>
<li><p><strong>versionminor</strong> (<em>int</em>) – Minor xharpy version number</p></li>
<li><p><strong>ishar</strong> (<em>bool</em><em>, </em><em>optional</em>) – refinement is a Hirshfeld Atom Refinement in XHARPy, by default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted atom_type table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.cif2data">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">cif2data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cif_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.cif2data" title="Permalink to this definition"></a></dt>
<dd><p>Function to generate the needed variables used for the futher refinement
from a given cif file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cif_path</strong> (<em>str</em>) – Path to the cif file, that should be used as source for the structure
information</p></li>
<li><p><strong>cif_dataset</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – dataset within that cif file, that is supposed to be used, when a string
is passed as the argrument, the dataset is selected by name. When an
integer is passed it is selected by index. If you have named with
numbering, pass the number as a string (e.g. ‘2’), by default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>atom_table</strong> (<em>pd.DataFrame</em>) – pandas DataFrame that contains the atomic information. Columns are named
like their counterparts in the cif file but without the common start for
each table (e.g. atom_site_fract_x -&gt; fract_x). All tables are merged on
the atom label. f’ and f’’ are merged on atom_type</p></li>
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>np.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple[jnp.ndarray, jnp.ndarray]</em>) – size (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>symm_instructions</strong> (<em>List[str]</em>) – List of symmetry instructions from the cif-file. Needed for writing a
new cif file</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Measurement wavelength in Angstroem</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.cif2space_group_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">cif2space_group_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cif</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">collections.OrderedDict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.cif2space_group_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Helper function the generate the space_group table from a given cif
file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cif</strong> (<em>OrderedDict</em>) – The dictionary generated from the read in cif file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted space_group table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.cif_entry_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">cif_entry_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">None</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">string_sign</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.cif_entry_string" title="Permalink to this definition"></a></dt>
<dd><p>Create a cif line from the given values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<em>str</em>) – Name of the cif entry without preceding underscore</p></li>
<li><p><strong>value</strong> (<em>Union</em><em>[</em><em>None</em><em>, </em><em>str</em><em>, </em><em>float</em><em>, </em><em>int</em><em>]</em>) – Value corresponding to the cif entry in one of the given types.</p></li>
<li><p><strong>string_sign</strong> (<em>bool</em><em>, </em><em>optional</em>) – Embed an entry of type cif ‘like this’, Lots of options in cif file are
formatted without the string sign if there is a limited number of
options. Can also be used to write out numerical values with esd,
by default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Output line for the cif entry</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Unknown variable type for value. Either implement or cast into one of
    the known ones (str with string_sign False should always work)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.ciflike_to_dict">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">ciflike_to_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_descr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolve_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.ciflike_to_dict" title="Permalink to this definition"></a></dt>
<dd><p>Function to read in cif or cif-like (e.g. fcf) files. Can return all
structures contained in the file. To return only the data of one structure
use return_descr to select by dataset name or index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – Path to a cif or cif-like file</p></li>
<li><p><strong>return_descr</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>, </em><em>None</em><em>]</em><em>, </em><em>optional</em>) – Can be used to only return a specific dataset from the cif file
if a string is given as argument, the dataset with that name is
returned. An integer will return the dataset by index (i.e. 0 will give
the first dataset in the file), None will return a dict with all
datasets, with the dataset name as key, by default None</p></li>
<li><p><strong>resolve_esd</strong> (<em>bool</em><em>, </em><em>optional</em>) – If this argrument is set to true, will split arguments, which have an
esd into two arguments: arg, arg_esd, False will return a string in this
case (i.e. ‘12(3)’), by default True</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>cif_content</strong> – Returns a dictionary of dataset_name, dataset_dict pairs or a single
dataset as OrderedDict. Within the dataset all entries are given as
key, value pairs with the key being the entry in the cif_file without
the preceding underscore. The routine will try to cast the value into
a float, int or string, depending on whether digits, digits and a dot
or other characters are present. All loops are given as a list of pandas
DataFrame objects under the ‘loops’ keyword.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Dict[str, Dict], Dict]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>e</strong> – If an exception occurs it is raised after printing the line in the cif
    file for debugging purposes</p></li>
<li><p><strong>ValueError</strong> – The return_descr was in an invalid type</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_angle_table">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_angle_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">angle_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_angle_table" title="Permalink to this definition"></a></dt>
<dd><p>Create a angle table for the given parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – List with tuples of atom names. Angles spanned the atoms
are output to the angle table</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted geom_angle table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_aniso_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_aniso_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_aniso_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Create a formatted atom_site_aniso table from the given arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted atom_site_aniso string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_atom_site_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_atom_site_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_atom_site_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to create the atom_site table from the refined parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted atom_site table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Non-implemented adp_type</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_diff_density_entries">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_diff_density_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaled_intensity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_factors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array([53,</span> <span class="pre">53,</span> <span class="pre">53])</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.io.create_diff_density_entries" title="Permalink to this definition"></a></dt>
<dd><p>This function currently only adds empty entries that need to be filled in
with cctbx as the current implementation produces significantly different
results</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_distance_table">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_distance_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bonds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crystal_system</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_distance_table" title="Permalink to this definition"></a></dt>
<dd><p>Create a distance table for the given parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bonds</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – List with tuples of atom names. Distances between the atoms in the pair
are output to the bond table</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>crystal_system</strong> (<em>str</em>) – Crystal system of the evaluated structure. Possible values are:
‘triclinic’, ‘monoclinic’ ‘orthorhombic’, ‘tetragonal’, ‘hexagonal’,
‘trigonal’ and ‘cubic’. Is considered for the esd calculation.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted geom_bond table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_extinction_entries">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_extinction_entries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_extinction_entries" title="Permalink to this definition"></a></dt>
<dd><p>Create the set of extinction related entries as string output</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with refinement options. For detailed options see refinement
function in core</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted string for output</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Used extinction method is not implemented in this output function</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_fcf4_table">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_fcf4_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index_vec_h</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">structure_factors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd_int</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaling</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_fcf4_table" title="Permalink to this definition"></a></dt>
<dd><p>Create a formatted fcf4 table for output in cif file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index_vec_h</strong> (<em>jnp.ndarray</em>) – size (H, 3) array of Miller indicees of observed reflections</p></li>
<li><p><strong>structure_factors</strong> (<em>jnp.ndarray</em>) – size (H)-sized array with complex structure factors for each reflection</p></li>
<li><p><strong>intensity</strong> (<em>jnp.ndarray</em>) – size (H) array of observed reflection intensities</p></li>
<li><p><strong>esd_int</strong> (<em>jnp.ndarray</em>) – Estimated standard deviation of the observed reflection intensites</p></li>
<li><p><strong>scaling</strong> (<em>float</em>) – overall scaling factor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>formatted fcf4 table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_gc3_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_gc3_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_gc3_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Create a formatted atom_site_anharm_GC_C table if any values are
different from zero</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted atom_site_anharm_GC_C table if any value different from zero,
otherwise an empty string is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.create_gc4_table_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">create_gc4_table_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.create_gc4_table_string" title="Permalink to this definition"></a></dt>
<dd><p>Create a formatted atom_site_anharm_GC_D table if any values are
different from zero</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – list of AtomInstructions used in the refinement.</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – variance covariance matrix of the final refinement step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Formatted atom_site_anharm_GC_D table if any value different from zero,
otherwise an empty string is returned</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.entries2atom_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">entries2atom_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfac_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xyz</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="headerlink" href="#xharpy.io.entries2atom_string" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to create a shelxl .res atom string from the given
parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<em>str</em>) – Atom label</p></li>
<li><p><strong>sfac_index</strong> (<em>int</em>) – SFAC index within shelxl</p></li>
<li><p><strong>xyz</strong> (<em>np.ndarray</em>) – fractional coordinates</p></li>
<li><p><strong>uij</strong> (<em>np.ndarray</em>) – Anisotropic displacement parameters</p></li>
<li><p><strong>occupancy</strong> (<em>float</em>) – occupancies</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The correct atomic string for the SHELXL output</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.fcf2hkl_pd">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">fcf2hkl_pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcf_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcf_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#xharpy.io.fcf2hkl_pd" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to generate a DataFrame from a given .fcf file. Might
also work with cif files if a fcf-like loop is present</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcf_path</strong> (<em>str</em>) – Path to the fcf file</p></li>
<li><p><strong>fcf_dataset</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – dataset within that fcf file, that is supposed to be used, when a string
is passed as the argrument, the dataset is selected by name. When an
integer is passed it is selected by index. If you have named with
numbering, pass the number as a string (e.g. ‘2’), by default 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hkl</strong> – Dataframe with named columns: ‘h’, ‘k’, ‘l’, ‘intensity’, ‘esd_int’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – The file contains no table with refln_F_squared_meas as a colum</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.generate_core_refinement_string">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">generate_core_refinement_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.io.generate_core_refinement_string" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.instructions_to_constraints">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">instructions_to_constraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><span class="pre">xharpy.core.ConstrainedValues</span></a></span></span><a class="headerlink" href="#xharpy.io.instructions_to_constraints" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to generate symmetry constraints for a special position
from a single atom entry in the the shelxl .lst file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – names of variables to search for at the call</p></li>
<li><p><strong>instructions</strong> (<em>str</em>) – instructions to search in</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A valid ConstrainedValues instance for the set of variables</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues">ConstrainedValues</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.lst2constraint_dict">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">lst2constraint_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues"><span class="pre">xharpy.core.ConstrainedValues</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.lst2constraint_dict" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to create a constraint dict for the refinement if atoms
on special positions are present. Make sure that atoms on special positions
are actually refined in SHELXL as you plan to refine them  in the refinement
in XHARPy. Use AFIX 1 if hydrogen atoms are located on special positions,
but you want to refine them anisotropically in the Hirshfeld refinement or
add the ConstraintValues variables manually. As SHELXL cannot refine Gram-
Charlier parameters, these need to be added manually for the time being.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<em>str</em>) – Path to the shelxl .lst file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>constraint_dict</strong> – Dictionary containing the generated constraints for the individual atoms
and parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, Dict[str, <a class="reference internal" href="#xharpy.core.ConstrainedValues" title="xharpy.core.ConstrainedValues">ConstrainedValues</a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.shelxl_hkl2pd">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">shelxl_hkl2pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hkl_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#xharpy.io.shelxl_hkl2pd" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to read in a shelx-style .hkl file as dataframe. Note
that XHARPy does expect a merged hkl file, using an unmerged file will
be very slow and lead to unexpected esd values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hkl_name</strong> (<em>str</em>) – Path to hkl file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hkl</strong> – Dataframe with named columns: ‘h’, ‘k’, ‘l’, ‘intensity’, ‘esd_int’ and
possibly ‘batch_no’ if six columns are present in the file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Number of columns is unexpected for a SHELX hkl file</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.split_error">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">split_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.split_error" title="Permalink to this definition"></a></dt>
<dd><p>Helper function to split a string containing a value with error in
brackets to a value-esd pair</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> (<em>str</em>) – Input string containing the value to be split</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Pair of floats if a ‘.’ was present in string, otherwise a pair of ints
containing the value and its esd</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Tuple[float, float], Tuple[int, int]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.symm_to_matrix_vector">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">symm_to_matrix_vector</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">instruction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.symm_to_matrix_vector" title="Permalink to this definition"></a></dt>
<dd><p>Converts a symmetry instruction into a symmetry matrix and a translation
vector for that symmetry element.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>instruction</strong> (<em>str</em>) – Instruction string containing symmetry instruction for all three
coordinates separated by comma signs (e.g -x, -y, 0.5+z)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>symm_matrix</strong> (<em>jnp.ndarray,</em>) – size (3, 3) array containing the symmetry matrix for the symmetry element</p></li>
<li><p><strong>symm_vector</strong> (<em>jnp.ndarray</em>) – size (3) array containing the translation vector for the symmetry element</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.value_with_esd">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">value_with_esd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.io.value_with_esd" title="Permalink to this definition"></a></dt>
<dd><p>Create string or strings with the values und estimated standard
deviation in the format xxx.xx(y). Will round to 6 digits if esd is
nan or zero. Can only handle one-dimensional arrays. So loop outside for use</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> (<em>np.ndarray</em>) – At maximum a one dimensional array containing the values</p></li>
<li><p><strong>esds</strong> (<em>np.ndarray</em>) – At maximum a one dimensional array containing the esds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>formatted_strings</strong> – string or strings that are formatted according to the style</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[List[str], str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.write_cif">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">write_cif</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cif_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shelx_cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shelx_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hkl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_cov_mat</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">computation_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">information</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_cif_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.io.write_cif" title="Permalink to this definition"></a></dt>
<dd><p>Write a cif file from the given parameters. Currently only works for gpaw
and iam refinements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_cif_path</strong> (<em>str</em>) – path where the new cif file is output</p></li>
<li><p><strong>cif_dataset</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – name of dataset in cif file</p></li>
<li><p><strong>shelx_cif_path</strong> (<em>str</em>) – Path to the shelx cif used for the refinement. For the time being is
used to copy some values, where the calculation is not implemented yet</p></li>
<li><p><strong>shelx_dataset</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – dataset within the shelx cif file</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>jnp.ndarray</em><em>, </em><em>jnp.ndarray</em><em>]</em>) – size (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>hkl</strong> (<em>pd.DataFrame</em>) – pandas DataFrame containing the reflection data. Needs to have at least
five columns: h, k, l, intensity, esd_int, Additional columns will be
ignored</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters from the
list of refined parameters</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>var_cov_mat</strong> (<em>jnp.ndarray</em>) – [description]</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with refinement options. For detailed options see refinement
function in core</p></li>
<li><p><strong>computation_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dict with options of the to the f0j_source.</p></li>
<li><p><strong>information</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with additional information, obtained from the refinement.
the atomic form factors will be read from this dict.</p></li>
<li><p><strong>source_cif_path</strong> (<em>str</em><em>, </em><em>optional</em>) – Additional cif that will be searched for crystal and measurement
information. If not given the shelx cif will be tried instead</p></li>
<li><p><strong>source_dataset</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – Dataset to use in the source_cif</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.write_fcf">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">write_fcf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcf_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcf_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcf_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hkl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_strings</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">information</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#xharpy.io.write_fcf" title="Permalink to this definition"></a></dt>
<dd><p>Write a fcf file from the results of the refinement for both archival
purposes and the visualisation of difference electron densities</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fcf_path</strong> (<em>str</em>) – Path, where the new fcf-file should be written</p></li>
<li><p><strong>fcf_dataset</strong> (<em>str</em>) – Dataset name within the fcf file.</p></li>
<li><p><strong>fcf_mode</strong> (<em>int</em>) – Can be either 4 or 6 at the momenent. See SHELXL documentation</p></li>
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>hkl</strong> (<em>pd.DataFrame</em>) – pandas DataFrame containing the reflection data. Needs to have at least
five columns: h, k, l, intensity, esd_int, Additional columns will be
ignored</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters from the
list of refined parameters</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Measurement wavelength in Angstroem</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with refinement options. For detailed options see refinement
function in core</p></li>
<li><p><strong>symm_strings</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – strings containing the symmetry information of the unit cell in the
usual cif format</p></li>
<li><p><strong>information</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with additional information, obtained from the refinement.
the atomic form factors will be read from this dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hkl</strong> – DataFrame with additional columns depending on the fcf mode used</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Selected a fcf mode, which was not implemented</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.write_res">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">write_res</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_res_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_res_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_esd</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.io.write_res" title="Permalink to this definition"></a></dt>
<dd><p>Write a SHELXL .res file for visualisation. Will always convert isotropic
displacement parameters to the equivalent anistropic ones. Input res is
still needed to get the LATT, SYMM and SFAC instructions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_res_path</strong> (<em>str</em>) – Path, where the new .res will be written</p></li>
<li><p><strong>in_res_path</strong> (<em>str</em>) – Input res file to copy some entries. Should also work with a .lst file</p></li>
<li><p><strong>cell</strong> (<em>jnp.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>cell_esd</strong> (<em>jnp.ndarray</em>) – array with the estimated standard deviation of the lattice constants
(Angstroem, Degree)</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters from the
list of refined parameters</p></li>
<li><p><strong>parameters</strong> (<em>jnp.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Measurement wavelength in Angstroem</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.io.xd_hkl2pd">
<span class="sig-prename descclassname"><span class="pre">xharpy.io.</span></span><span class="sig-name descname"><span class="pre">xd_hkl2pd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="headerlink" href="#xharpy.io.xd_hkl2pd" title="Permalink to this definition"></a></dt>
<dd><p>Returns the reflection intensity DataFrame from an XD hkl file.
Currently, only F^2 with NDAT 7 is implemented as format</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<em>str</em>) – Path to hkl file</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>hkl</strong> – Dataframe with named columns: ‘h’, ‘k’, ‘l’, ‘dataset’, ‘intensity’,
‘esd_int’, ‘scale’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Format of xd.hkl currently not implemented.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-xharpy.paper">
<span id="xharpy-paper-module"></span><h2>xharpy.paper module<a class="headerlink" href="#module-xharpy.paper" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.box_options">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">box_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">color</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widths</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.35</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.box_options" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.calc_s12">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">calc_s12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mat_u1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mat_u2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.calc_s12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.calculate_agreement">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">calculate_agreement</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">har_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">har_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fcf_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neut_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">neut_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rename_dict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adp_conversions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.calculate_agreement" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_cubic">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_cubic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_cubic" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_cubic_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_cubic_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_cubic_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_hexa">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_hexa</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_hexa" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_hexa_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_hexa_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_hexa_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_mono">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_mono</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_mono" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_mono_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_mono_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_mono_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_ortho">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_ortho</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_ortho" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_ortho_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_ortho_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_ortho_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_tetra">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_tetra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_tetra" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_tetra_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_tetra_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_tetra_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_tric">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_tric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_tric" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.corr_uij_tric_nosc">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">corr_uij_tric_nosc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij_neut</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.corr_uij_tric_nosc" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.figure_height">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">figure_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_dataset</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.figure_height" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.gen_lsq">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">gen_lsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">corr_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.gen_lsq" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.paper.plot_heatmap">
<span class="sig-prename descclassname"><span class="pre">xharpy.paper.</span></span><span class="sig-name descname"><span class="pre">plot_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rows</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'diverging'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.paper.plot_heatmap" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-xharpy.quality">
<span id="xharpy-quality-module"></span><h2>xharpy.quality module<a class="headerlink" href="#module-xharpy.quality" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.quality.calculate_drk">
<span class="sig-prename descclassname"><span class="pre">xharpy.quality.</span></span><span class="sig-name descname"><span class="pre">calculate_drk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">21</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equal_sized_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.quality.calculate_drk" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.quality.calculate_quality_indicators">
<span class="sig-prename descclassname"><span class="pre">xharpy.quality.</span></span><span class="sig-name descname"><span class="pre">calculate_quality_indicators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cell</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">symm_mats_vecs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hkl</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">construction_instructions</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><span class="pre">xharpy.core.AtomInstructions</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavelength</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">refinement_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">information</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="headerlink" href="#xharpy.quality.calculate_quality_indicators" title="Permalink to this definition"></a></dt>
<dd><p>[summary]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cell</strong> (<em>np.ndarray</em>) – array with the lattice constants (Angstroem, Degree)</p></li>
<li><p><strong>symm_mats_vecs</strong> (<em>Tuple</em><em>[</em><em>np.ndarray</em><em>, </em><em>np.ndarray</em><em>]</em>) – (K, 3, 3) array of symmetry matrices and (K, 3) array of translation
vectors for all symmetry elements in the unit cell</p></li>
<li><p><strong>hkl</strong> (<em>pd.DataFrame</em>) – pandas DataFrame containing the reflection data. Needs to have at least
five columns: h, k, l, intensity, esd_int, Additional columns will be
ignored</p></li>
<li><p><strong>construction_instructions</strong> (<em>List</em><em>[</em><a class="reference internal" href="#xharpy.core.AtomInstructions" title="xharpy.core.AtomInstructions"><em>AtomInstructions</em></a><em>]</em>) – List of instructions for reconstructing the atomic parameters from the
list of refined parameters</p></li>
<li><p><strong>parameters</strong> (<em>np.ndarray</em>) – final refined parameters</p></li>
<li><p><strong>wavelength</strong> (<em>float</em>) – Measurement wavelength in Angstroem</p></li>
<li><p><strong>refinement_dict</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with refinement options</p></li>
<li><p><strong>information</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary with additional information, obtained from the refinement.
the atomic form factors will be read from this dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>quality_dict</strong> – Dictionary with different quality indicators.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, float]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.quality.generate_hm">
<span class="sig-prename descclassname"><span class="pre">xharpy.quality.</span></span><span class="sig-name descname"><span class="pre">generate_hm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fcf_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">map_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3333333333333333</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.quality.generate_hm" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-xharpy.restraints">
<span id="xharpy-restraints-module"></span><h2>xharpy.restraints module<a class="headerlink" href="#module-xharpy.restraints" title="Permalink to this headline"></a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestrInd">
<span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">FixedDistanceRestrInd</span></span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestrInd" title="Permalink to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">xharpy.restraints.DistanceRestrInd</span></code></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">FixedDistanceRestraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestraint.atom1">
<span class="sig-name descname"><span class="pre">atom1</span></span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestraint.atom1" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestraint.atom2">
<span class="sig-name descname"><span class="pre">atom2</span></span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestraint.atom2" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestraint.distance">
<span class="sig-name descname"><span class="pre">distance</span></span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestraint.distance" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.FixedDistanceRestraint.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.FixedDistanceRestraint.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestrInd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">RigidADPRestrInd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.RigidADPRestrInd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestrInd.atom1_index">
<span class="sig-name descname"><span class="pre">atom1_index</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestrInd.atom1_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestrInd.atom2_index">
<span class="sig-name descname"><span class="pre">atom2_index</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestrInd.atom2_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestrInd.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestrInd.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestrInd.mult">
<span class="sig-name descname"><span class="pre">mult</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestrInd.mult" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">RigidADPRestraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.RigidADPRestraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestraint.atom1">
<span class="sig-name descname"><span class="pre">atom1</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestraint.atom1" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestraint.atom2">
<span class="sig-name descname"><span class="pre">atom2</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestraint.atom2" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestraint.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestraint.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.RigidADPRestraint.mult">
<span class="sig-name descname"><span class="pre">mult</span></span><a class="headerlink" href="#xharpy.restraints.RigidADPRestraint.mult" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestrInd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">SameADPRestrInd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2_index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.SameADPRestrInd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestrInd.atom1_index">
<span class="sig-name descname"><span class="pre">atom1_index</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestrInd.atom1_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestrInd.atom2_index">
<span class="sig-name descname"><span class="pre">atom2_index</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestrInd.atom2_index" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestrInd.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestrInd.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestrInd.mult">
<span class="sig-name descname"><span class="pre">mult</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestrInd.mult" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">SameADPRestraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mult</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.SameADPRestraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestraint.atom1">
<span class="sig-name descname"><span class="pre">atom1</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestraint.atom1" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestraint.atom2">
<span class="sig-name descname"><span class="pre">atom2</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestraint.atom2" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestraint.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestraint.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameADPRestraint.mult">
<span class="sig-name descname"><span class="pre">mult</span></span><a class="headerlink" href="#xharpy.restraints.SameADPRestraint.mult" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 3</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestrInd">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">SameDistanceRestrInd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_pair_indexes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestrInd" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestrInd.atom_pair_indexes">
<span class="sig-name descname"><span class="pre">atom_pair_indexes</span></span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestrInd.atom_pair_indexes" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestrInd.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestrInd.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestraint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">SameDistanceRestraint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_pairs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestraint" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestraint.atom_pairs">
<span class="sig-name descname"><span class="pre">atom_pairs</span></span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestraint.atom_pairs" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="xharpy.restraints.SameDistanceRestraint.esd">
<span class="sig-name descname"><span class="pre">esd</span></span><a class="headerlink" href="#xharpy.restraints.SameDistanceRestraint.esd" title="Permalink to this definition"></a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.restraints.create_restraint_instructions">
<span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">create_restraint_instructions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom_table</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.create_restraint_instructions" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="xharpy.restraints.resolve_restraints">
<span class="sig-prename descclassname"><span class="pre">xharpy.restraints.</span></span><span class="sig-name descname"><span class="pre">resolve_restraints</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xyz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uij</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">restraints</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_mat_m</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#xharpy.restraints.resolve_restraints" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-xharpy.weighting">
<span id="xharpy-weighting-module"></span><h2>xharpy.weighting module<a class="headerlink" href="#module-xharpy.weighting" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="xharpy.weighting.calc_weights">
<span class="sig-prename descclassname"><span class="pre">xharpy.weighting.</span></span><span class="sig-name descname"><span class="pre">calc_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wght_parameters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">c_mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">intensity_pos</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">i_calc</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">esd_int</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sintheta_ov_lambda</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">jax._src.numpy.lax_numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">jax._src.numpy.lax_numpy.ndarray</span></span></span><a class="headerlink" href="#xharpy.weighting.calc_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate weights for given arguments</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wght_parameters</strong> (<em>jnp.ndarray</em>) – size (6) array containing the weight parameters</p></li>
<li><p><strong>c_mode</strong> (<em>float</em>) – in order to be able to call this with derivatives c_mode needs
to be called separately</p></li>
<li><p><strong>intensity_pos</strong> (<em>jnp.ndarray</em>) – experimental observed intensities</p></li>
<li><p><strong>i_calc</strong> (<em>jnp.ndarray</em>) – calculated intensities from the refinement</p></li>
<li><p><strong>esd_int</strong> (<em>jnp.ndarray</em>) – estimated standard deviations of the observed intensities</p></li>
<li><p><strong>sintheta_ov_lambda</strong> (<em>jnp.ndarray</em><em>, </em><em>optional</em>) – if c_mode != 0 needed sin(theta)/lambda values, by default None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights for the individual reflections</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jnp.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-xharpy">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-xharpy" title="Permalink to this headline"></a></h2>
<p>[summary]</p>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="xharpy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="xharpy.f0j_sources.html" class="btn btn-neutral float-right" title="xharpy.f0j_sources package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Paul Niklas Ruth.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>